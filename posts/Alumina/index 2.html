<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Leitch">
<meta name="dcterms.date" content="2023-07-30">

<title>Alumina electrification would be a big win – ITK Research</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../ITK_logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-485e50d28d76f17c9a54ab231639fb97.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-f9f99e9f92a7e94224d7c17645ae6320.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Alumina electrification would be a big win – ITK Research">
<meta property="og:description" content="Electricity markets analysis">
<meta property="og:image" content="https://itkservices3.com/posts/Alumina/media/media/image9.png">
<meta property="og:site_name" content="ITK Research">
<meta property="og:image:height" content="632">
<meta property="og:image:width" content="1017">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../ITK_logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ITK Research</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../forecast.html"> 
<span class="menu-text">AEMO demand fcst</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../nem-dash.html"> 
<span class="menu-text">NEM-dash</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../IEA.html"> 
<span class="menu-text">IEA-electricity</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Articles</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../presentations.html"> 
<span class="menu-text">Presentations</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="../../posts.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../mailchimp.html"> 
<span class="menu-text">Signup</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Alumina electrification would be a big win</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">analysis</div>
                <div class="quarto-category">QLD</div>
                <div class="quarto-category">aluminium</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>David Leitch </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 30, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-main-benefit-of-decarbonising-alumina-is-cheaper-energy-the-decarbonisation-benefit-is-secondary" id="toc-the-main-benefit-of-decarbonising-alumina-is-cheaper-energy-the-decarbonisation-benefit-is-secondary" class="nav-link active" data-scroll-target="#the-main-benefit-of-decarbonising-alumina-is-cheaper-energy-the-decarbonisation-benefit-is-secondary">The main benefit of decarbonising alumina is cheaper energy, the decarbonisation benefit is secondary</a></li>
  <li><a href="#aluminum-is-10-of-nem-electricity-consumption" id="toc-aluminum-is-10-of-nem-electricity-consumption" class="nav-link" data-scroll-target="#aluminum-is-10-of-nem-electricity-consumption">Aluminum is 10% of NEM electricity consumption</a></li>
  <li><a href="#australia-currently-produces-14-of-the-worlds-alumina" id="toc-australia-currently-produces-14-of-the-worlds-alumina" class="nav-link" data-scroll-target="#australia-currently-produces-14-of-the-worlds-alumina">Australia currently produces 14% of the world’s alumina</a></li>
  <li><a href="#alumina-is-behind-only-lng-and-power-generation-as-a-gas-consumer-in-australia" id="toc-alumina-is-behind-only-lng-and-power-generation-as-a-gas-consumer-in-australia" class="nav-link" data-scroll-target="#alumina-is-behind-only-lng-and-power-generation-as-a-gas-consumer-in-australia">Alumina is behind only LNG and power generation as a gas consumer in Australia</a></li>
  <li><a href="#alumina-refineries-are-well-suited-to-solar-power-they-can-offer-very-large-scale-demand-response." id="toc-alumina-refineries-are-well-suited-to-solar-power-they-can-offer-very-large-scale-demand-response." class="nav-link" data-scroll-target="#alumina-refineries-are-well-suited-to-solar-power-they-can-offer-very-large-scale-demand-response.">Alumina refineries are well suited to solar power, they can offer very large scale demand response.</a>
  <ul class="collapse">
  <li><a href="#the-alumina-production-process" id="toc-the-alumina-production-process" class="nav-link" data-scroll-target="#the-alumina-production-process">The alumina production process</a></li>
  </ul></li>
  <li><a href="#focus-on-qld-as-no-aluminum-in-wa" id="toc-focus-on-qld-as-no-aluminum-in-wa" class="nav-link" data-scroll-target="#focus-on-qld-as-no-aluminum-in-wa">Focus on QLD as no aluminum in WA</a></li>
  <li><a href="#it-really-works-in-the-spreadsheet" id="toc-it-really-works-in-the-spreadsheet" class="nav-link" data-scroll-target="#it-really-works-in-the-spreadsheet">It really works (in the spreadsheet)</a></li>
  <li><a href="#problems---what-problems" id="toc-problems---what-problems" class="nav-link" data-scroll-target="#problems---what-problems">Problems - what problems?</a>
  <ul class="collapse">
  <li><a href="#its-not-that-easy-to-get-12-gw-of-wind-and-solar-capacity" id="toc-its-not-that-easy-to-get-12-gw-of-wind-and-solar-capacity" class="nav-link" data-scroll-target="#its-not-that-easy-to-get-12-gw-of-wind-and-solar-capacity">Its not that easy to get 12 GW of wind and solar capacity</a></li>
  <li><a href="#process-heat-storage-what-it-is-and-how-expensive" id="toc-process-heat-storage-what-it-is-and-how-expensive" class="nav-link" data-scroll-target="#process-heat-storage-what-it-is-and-how-expensive">Process heat storage – what it is and how expensive</a></li>
  <li><a href="#spot-energy" id="toc-spot-energy" class="nav-link" data-scroll-target="#spot-energy">Spot energy</a></li>
  <li><a href="#lost-alumina-production-is-about-10-of-output." id="toc-lost-alumina-production-is-about-10-of-output." class="nav-link" data-scroll-target="#lost-alumina-production-is-about-10-of-output.">Lost alumina production is about 10% of output.</a></li>
  <li><a href="#site-specific-considerations" id="toc-site-specific-considerations" class="nav-link" data-scroll-target="#site-specific-considerations">Site specific considerations</a></li>
  </ul></li>
  <li><a href="#imaginary-economics" id="toc-imaginary-economics" class="nav-link" data-scroll-target="#imaginary-economics">Imaginary economics</a></li>
  <li><a href="#using-qld-and-nsw-wind-together-with-qld-solar" id="toc-using-qld-and-nsw-wind-together-with-qld-solar" class="nav-link" data-scroll-target="#using-qld-and-nsw-wind-together-with-qld-solar">Using QLD and NSW wind together with QLD solar</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="the-main-benefit-of-decarbonising-alumina-is-cheaper-energy-the-decarbonisation-benefit-is-secondary" class="level1">
<h1>The main benefit of decarbonising alumina is cheaper energy, the decarbonisation benefit is secondary</h1>
<p>Most of the excellent research that has looked at Australia’s alumina sector has focussed on the potential reduction in carbon emissions. However as an electricity analyst what I see is an absolutely massive demand response/battery. <strong><em>Alumina</em> refineries in QLD can potentially provide the same amount of storage/demand response as a 2 GW/8 hour battery</strong>. To see how this can be the case, at least from within the reality distortion bubble of this note read on.</p>
<p>A reminder of the aluminium production process</p>
<p><a href="media/media/image1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="media/media/image1.png" style="width:6.26389in;height:2.72083in"></a></p>
<p>Figure 1 Aluminium production, source: Australian Aluminium Council</p>
<p>The aim in this note is to show the economic potential of the alumina refinery to firm renewable energy provided to an aluminum smelter at pretty much a break even price. Or at least its a break even in my reality distortion bubble. Decarbonisation is a side benefit. So is freeing up 46 PJ of annual gas consumption to remain in the ground.</p>
</section>
<section id="aluminum-is-10-of-nem-electricity-consumption" class="level1">
<h1>Aluminum is 10% of NEM electricity consumption</h1>
<p>Aluminum is still about the largest single consumer of electricity in Australia. Its responsible for 10% roughly of consumption in each of NSW, QLD and Victoria and probably more in Tasmania.</p>
<p>For some years many of us having been thinking about how to replace coal fuelled electricity with renewable electricity for aluminum smelting. However the difficulty (thanks Matt Howell ) is that aluminum smelting is basically a non interruptible process. Although you can cut power to a smelter for a couple of hours every now and then, doing so impacts the “pot” life and its really not what the process wants to do. So aluminum production is much better suited to something like hydro than to wind and solar. So in the absence of any intervention you would basically expect global production of aluminum to shift from coal intensive areas like China to hydro intensive areas like Russia and Canada as decarbonisation becomes a bigger and bigger deal.</p>
<p>This means that Australian smelters are at risk of closing. They face environmental costs which their Chinese competitors do not and they are not as easy to repower as it might seem. Even though smelter owners are notorious for wanting government handouts the basic reality is that they sell the product in a global market and it has to be one way or another globally competitive. This can be on cost where electricity is normally the sole differentiator of costs or it could be on value if there was say a “green” premium. But basically its cost.</p>
<p>Even though Australian wind and solar costs are likely very competitive with hydro it’s the firming component that’s difficult. So what looked like the obvious way to go about things was maybe not so obvious. Recently though I’ve been thinking a lot about the intermediate step in the aluminum process and that’s alumina.</p>
</section>
<section id="australia-currently-produces-14-of-the-worlds-alumina" class="level1">
<h1>Australia currently produces 14% of the world’s alumina</h1>
<p>Australia has the largest, but not necessarily most economic, reserves of bauxite and Australia is a significant global producer for alumina. However, at least in Queenland the alumina refineries are old.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="media/media/image2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="A graph showing the growth of the world alumina production Description automatically generated"><img src="media/media/image2.png" style="width:6.26389in;height:4.15in" alt="A graph showing the growth of the world alumina production Description automatically generated" class="figure-img"></a></p>
<figcaption>A graph showing the growth of the world alumina production Description automatically generated</figcaption>
</figure>
</div>
<p>Figure 2 Global aluminium production. Source: International aluminium institute</p>
</section>
<section id="alumina-is-behind-only-lng-and-power-generation-as-a-gas-consumer-in-australia" class="level1">
<h1>Alumina is behind only LNG and power generation as a gas consumer in Australia</h1>
<p>The next thing to appreciate is that alumina is the largest single consumer of gas in Australia outside of electricity generation and LNG production with total consumption in excess of 220 PJ. The overall flow of gas in Australia is shown below and I tip my hat to an excellent Sankey diagram:</p>
<p><a href="media/media/image3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="media/media/image3.png" style="width:6.26389in;height:3.62708in"></a></p>
<p>Figure 3 Australian gas production and uses. Source: Dept of Climate change</p>
<p>Eliminating gas in alumina would have a bigger impact than eliminating gas from all residential consumption let alone new consumption.</p>
</section>
<section id="alumina-refineries-are-well-suited-to-solar-power-they-can-offer-very-large-scale-demand-response." class="level1">
<h1>Alumina refineries are well suited to solar power, they can offer very large scale demand response.</h1>
<p><strong>The most important point to understand in this note is that alumina refineries and particular the digestors are flexible.</strong> Like a pot on the stove they can be turned up and down with no damage other than a loss of production. This potentially makes them incredibly useful when coupled with solar energy. It also may be possible, ah say MAY be possible, to store excess process heat from the digestor and release it over night.</p>
<p>So the ultimate idea is to run the flexible alumina refinery and the aluminum smelter next door on solar and wind energy. The refinery is run mainly on solar during the day with the excess heat stored. Over night the refinery cuts its wind solar input right down and supplements it with stored heat. The wind that the refinery consumes during the day then becomes available to the inflexible aluminium smelter next door to replace essentially lost solar production.</p>
<p>In addition any time the wind and solar input has a drought it’s the flexible refinery that takes the hit and the smelter largely keeps on going.</p>
<p>External firming may still be required but much less often freeing up the firming capacity, eg Borumba, for other uses. Indeed for those rare occasions where State wide there is such a drought that the refinery and Borumba cant handle it then backup generation (eg gas) is called into action.</p>
<section id="the-alumina-production-process" class="level2">
<h2 class="anchored" data-anchor-id="the-alumina-production-process">The alumina production process</h2>
<p><a href="media/media/image4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="media/media/image4.png" style="width:6.26389in;height:2.20556in"></a></p>
<p>Figure 4 Alumina production process. Source: Australian aluminium council</p>
<p>The digestor consumes about 2/3 of the energy used in an alumina refinery and about 1/3 is used in the calciner. To cut a long story short to decarbonise the calciner most likely requires hydrogen. I ignore the more expensive problem of decarbonsing the calcining leg of alumina manufacturing..</p>
<p>The digestor which is basically a steam kettle can, if you were building a new refinery, “easily” be made to run on electricity and at relatively high efficiency. In the most basic view you just replace the gas heat with resistive heating.</p>
</section>
</section>
<section id="focus-on-qld-as-no-aluminum-in-wa" class="level1">
<h1>Focus on QLD as no aluminum in WA</h1>
<p>Using alumina refineries as demand response/batteries doesn’t require a coupled aluminum smelter but if they are coupled as in Gladstone it fits in very nicely with the coordinated industrial region approach that is increasingly regarded as the lowest cost and most efficient way to approach industrial decarbonisation see <a href="https://energytransitionsinitiative.org/wp-content/uploads/2022/06/Setting-up-industrial-regions-for-net-zero-Australian-Industry-ETI-report-JUNE-2022.pdf">Climate works report</a>. Indeed the use of alumina refineries as storage/demand response is exactly the sort of thing that emerges from a broader look.</p>
<p>A quick estimate is that the digestors use around 12-13 TWh of energy in QLd</p>
<p><img src="media/media/image5.png" style="width:6.09722in;height:1.375in">Figure 5 Alumina digestor energy. Source: Derived from ARENA report</p>
<p>So the alumina refineries in QLD use more energy even in the boilers, and before considering “double digestors” than the aluminum smelter.</p>
<p><a href="media/media/image6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="media/media/image6.png" style="width:3.63889in;height:1.88889in"></a></p>
<p>Figure 6 Australian aluminium smelter capacity. Source: ITK</p>
<p>So the combined QLD position is a requirement for about 22 TWh of renewable energy of which 60% is flexible demand:</p>
<p><a href="media/media/image7.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="media/media/image7.png" style="width:4.75in;height:1.375in"></a></p>
<p>Figure 7 Gladstone aluminium complex. Source: ITK estimates</p>
<p>However since the idea in this note is to store digestor heat from solar energy we need more solar and more GW.</p>
<p>The first thing to note is that QLD total operational consumption was about 54 TWh last year so adding in the alumina refinery adds about 25% to consumption. Equally it frees up gas for other uses but that is of no concern to this note. 13 TWh is broadly equivalent to 1.4 GW of flat load and if we consider it to be a battery its about 70% the proposed size of the power that Borumba can provide. I won’t bore anyone with social license issues but unless I am even more clueless than I think I am then providing a clear future for the refineries is likely to be a social license winner.</p>
<p>What it would require is 12 rather than 8 GW of wind and solar, the more solar the more GW. But in fact its more than that, because enough power has to be produced in the middle of the day to fill the refinery storage for overnight operation. I compiled the portfolio to ensure that on average there was enough renewable average to cover demand for every half hour of the average day.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="media/media/image8.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="A pie chart with numbers and a diagram with Crust in the background Description automatically generated"><img src="media/media/image8.png" style="width:6.26389in;height:4.15in" alt="A pie chart with numbers and a diagram with Crust in the background Description automatically generated" class="figure-img"></a></p>
<figcaption>A pie chart with numbers and a diagram with Crust in the background Description automatically generated</figcaption>
</figure>
</div>
<p>Figure 8 VRE portfolio to run Gladstone</p>
</section>
<section id="it-really-works-in-the-spreadsheet" class="level1">
<h1>It really works (in the spreadsheet)</h1>
<p>The smelter load is 960 MW and the underlying alumina digestor load is 1800 MW. The digestor is run in two modes, peak and offpeak. Peak is when its sunny. During this mode the digestor uses excess daytime solar to charge its storage. This storage is assumed to be “cheap” storage of process heat. In this case the stored heat is just used to partly run the digestor at night. This is more than twice as efficient as using the stored heat to run a turbine that makes electricity. In this system the energy losses are very low. In the turbine case more than half the heat is wasted.</p>
<p>The digestor was modelled to run using an input power of 900 MW in non solar hours supplemented by storage. Again this is a guess. The process heat storage was enough to provide the missing 900 MW during non solar hours. In this model about 15 GWh of process heat storage is required (providing about 900 MW for roughly 16 hours a day) . To charge the storage and also run the refinery and smelter during the day required 4.5 GW of input power. However only 1800 MW of input power is required over night.</p>
<p>The most important point is that the smelter itself only needs 960 MW. Since the system has been sized to provide at least 1800 MW on average over night, it takes a severe wind drought for the smelter to need outside power.</p>
<p>The following chart shows how it works on average day over 508,000 modelled half hours using adjusted AEMO provided wind and solar REZ traces for the period 2024-2050.</p>
<p><a href="media/media/image9.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="media/media/image9.png" style="width:6.26389in;height:3.89653in"></a></p>
<p>Figure 9 Alumium smelter and alumin digestor run on wind and solar, average day. Source: ITK</p>
<p>This graph is of course just an average. If wind and solar output falls away then initially the burden falls on the refinery and some refinery output is lost. But the refinery can easily cope. <strong>Our main concern is keeping the power up to the smelter</strong>.</p>
<p>It turns out that for this model there are about 4200 half hours out of 508,000 modelled, that is less than 1% of the time, where there is not enough wind and solar to run the smelter. The following figure shows the distribution of those half hours by the shortfall.</p>
<p><a href="media/media/image10.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="media/media/image10.png" style="width:4.01389in;height:2.30556in"></a></p>
<p>Figure 10 Need for aluminum smelter firming. Source: ITK</p>
<p>You can see that for 500 hours (0.1%) of the time 300-500 MW of external firming is required. A gas generator or a battery could do that easily. It’s a trivial problem.</p>
</section>
<section id="problems---what-problems" class="level1">
<h1>Problems - what problems?</h1>
<p>If it was this easy it would have been done already.</p>
<section id="its-not-that-easy-to-get-12-gw-of-wind-and-solar-capacity" class="level2">
<h2 class="anchored" data-anchor-id="its-not-that-easy-to-get-12-gw-of-wind-and-solar-capacity">Its not that easy to get 12 GW of wind and solar capacity</h2>
<p>Looking at the physical problems the first question is how easy is it in reality to get 12 GW of wind and solar destined for Gladstone? Right now we can’t get any new wind in NSW and even in “can do” QLD things are not really running all that hot just yet.</p>
</section>
<section id="process-heat-storage-what-it-is-and-how-expensive" class="level2">
<h2 class="anchored" data-anchor-id="process-heat-storage-what-it-is-and-how-expensive">Process heat storage – what it is and how expensive</h2>
<p>Solar thermal electricity has had a bad wrap recently. Its expensive and some plants have had operational issues. The biggest negative on such systems is the energy inefficiency. That’s because the stored heat has to be convereted to electricity by running it through a conventional turbine, often at quite low heat. However in this case the heat is reused as heat.</p>
<p>In Europe at low temperatures water can store lots of heat and can be used in “district” heating. At higher temperatures molten salt is typically used but there are some corrosion issues.</p>
<p>It comes down to material costs, material life, the volume of material required to store the heat, and how long the heat can be stored. For alumina digestors it’s a relatively simple problem. The heat doesn’t have to be stored for very long because it’s a daily cycle, and nor is there any transport of it required.</p>
<p>For most of the thermal storage technologies the cost of the storage medium is extremely cheap, but the balance of costs need to be managed. For example, storing heat in very high temperature water can store a lot of energy in a very cheap medium, but the pressure tank required would be enormously expensive. The view is that for something like Alumina refineries, refactory bricks and molten salts are the leading technologies. Some general comments are:&nbsp;</p>
<p><strong>Molten salt</strong>&nbsp;– Proven. Pressure issues if you let it freeze (don’t do that). Corrosion issues and hard to pump. Nitrate salts are only in Chile and there are price shocks in concert with fertilizer.</p>
<p><strong>Refractory brick</strong>&nbsp;– Proven. Still very cheap, but not as cheap as rocks or water. The “tank” is very cheap, just an insulated box. Scales really well – uses the three most abundant elements on Earth. No pressure/creep/degradation. No oxidation.&nbsp;</p>
<p>No special fluids or equipment. Charges fast during offpeak, but not as good on discharge, good enough to deliver baseload heat plus a bit of flex.</p>
<p><strong>Sand/rocks</strong>&nbsp;– Very cheap/abundant medium. Thermal expansion creates pressure on the tank, eventually the medium crushes into dust. Needs stronger blower to get heat in/out which increases auxiliary losses.</p>
<p><strong>Molten metal</strong>&nbsp;– good heat capacity [not actually valuable in stationary applications]. Oxidises in hot air – needs special barrier or fluid. Unproven material science for a long-lived asset.</p>
<p><strong>Graphite</strong>&nbsp;– very conductive so easy to get heat in/out. Not cheap, but not prohibitive. Supply competition with lithium batteries. Catches fire in hot air – needs special fluid blanket.</p>
<p><strong>Concrete</strong>&nbsp;– usually bad with heat, no particular advantages</p>
<p>If I pulled a number out of thin air of A$100/KWh capital cost, then 15 GWh costs $1500 million, just as an example.</p>
<p>The real point is if you want to run the smelter on renewable energy it needs 24 x 7 firmed power. Considering the smelter alone, the MW involved, that’s likely to be expensive. Using the flexible refineries produces a lot of value.</p>
</section>
<section id="spot-energy" class="level2">
<h2 class="anchored" data-anchor-id="spot-energy">Spot energy</h2>
<p>Despite the flexibility of the system there will be many occasions where generation is way too high for the alumina/aluminum system to handle. That’s because I’ve sized the system to ensure that on average there is enough power available.</p>
<p>The overall portfolio outputs are summarised below. On average there is 0.8 GW of spot energy available with a max of 6.3 GW. That is not a bad thing . It can be used for many other purposes including contributing significantly to QLD electricity supply or running say hydrogen fuelled calcining.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="media/media/image11.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="A screenshot of a computer Description automatically generated"><img src="media/media/image11.png" style="width:6.26389in;height:2.33194in" alt="A screenshot of a computer Description automatically generated" class="figure-img"></a></p>
<figcaption>A screenshot of a computer Description automatically generated</figcaption>
</figure>
</div>
<p>Figure 11 VRE portfolio summary. Source: ITK</p>
<p>Shortfall in the figure above is when VRE output is not enough to run the smelter and refinery at full capacity.It is assumed to result in lost alumina production at a rate of 1 tonne per 2 MWh</p>
<p>If we look at the daily distribution of the spot excess using the median rather than the average, so avoiding extremes there is still typically up to 2.5 GW surplus as the sun rises and as it sets because that is when the solar output is most volatile. At other times there is about 500-600 MW surplus to run overnight demand elsewhere. Notionally that surplus is relatively high value.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="media/media/image12.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="A graph of a graph Description automatically generated"><img src="media/media/image12.png" style="width:4.88889in;height:2.75in" alt="A graph of a graph Description automatically generated" class="figure-img"></a></p>
<figcaption>A graph of a graph Description automatically generated</figcaption>
</figure>
</div>
<p>Figure 12 Portfolio surplus output.</p>
</section>
<section id="lost-alumina-production-is-about-10-of-output." class="level2">
<h2 class="anchored" data-anchor-id="lost-alumina-production-is-about-10-of-output.">Lost alumina production is about 10% of output.</h2>
<p>Wind and solar input will rarely exactly equal demand. In most half hours there will be excess or shortfall. As discussed the excess can be sold on the market and in this model the shortfall is valued as lost production, roughly 700kt or 10% of annual output.</p>
</section>
<section id="site-specific-considerations" class="level2">
<h2 class="anchored" data-anchor-id="site-specific-considerations">Site specific considerations</h2>
<p>I have no real idea of how practical this system is. I don’t have any idea what the cost of a competitive alumina refinery is. I don’t really know whether there is enough space for the thermal storage imagined in this model. I have no concept of transmission issues.</p>
<p>The biggest unknown for me in regard to economics is the cost and performance of thermal storage.</p>
</section>
</section>
<section id="imaginary-economics" class="level1">
<h1>Imaginary economics</h1>
<p>In this section I make up some price assumptions and fiddle with the numbers until I get the result I want. Uh hang on that’s what I used to do in the research dept. This is the real deal. Just kidding. In fact you can make up any numbers you want for the input prices. These numbers are overnight costs ignoring transmission. The “green” price is assumed to be a constant. Somehow you can purchase wind and solar for $60/MWh and get an REC with a value of $30 thrown in. Then you can turn around and sell the surplus output for $50/MWh but without the certificate.</p>
<p>On the other hand who knows what coal generation will cost in QLD going forward. Its kind of a moot point because its all supposed to go away.</p>
<p>However the biggest point maybe that you only need a normal as opposed to do gooder, super greenie level of optimism to make the numbers seem possible.</p>
<p>I suspect that there are a few lines missing in these sums but no doubt the many eagle eyed readers will be quickly alert me to the many errors.</p>
<p><a href="media/media/image13.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="media/media/image13.png" style="width:5.125in;height:7.90278in"></a></p>
<p>Figure 13 Decarbonising Gladstone aluminum production. Source: ITK dept of imagination</p>
</section>
<section id="using-qld-and-nsw-wind-together-with-qld-solar" class="level1">
<h1>Using QLD and NSW wind together with QLD solar</h1>
<p>In ITK’s opinion any large QLD renewable project that doesn’t take advantage of the portfolio benefit of including some NSW wind is nuts.</p>
<p>The following figure shows the correlation of wind output between the various Queensland and NSW REZs. Basically the deeper the brown colour the less correlated the two zones are and therefore the lower variability of a wind portfolio that combines them. Some zones actually are negatively correlated. Negative correlation is wonderful if you can get. It means that when one zone isn’t blowing the other one is likely to be blowing. Careful perusal of the “map” will show that combining Q3 and Q4 wind with N7 and N8 wind would be a good idea. It might be that in reality that can only be done financially.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="media/media/image14.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="A graph of different colored squares Description automatically generated"><img src="media/media/image14.png" style="width:5.36111in;height:2.80556in" alt="A graph of different colored squares Description automatically generated" class="figure-img"></a></p>
<figcaption>A graph of different colored squares Description automatically generated</figcaption>
</figure>
</div>
<p>Figure 14 NSW and QLD REZ wind correlations. Source AEMO 2022 ISP, ITK calculations</p>
<p>The map below shows the zone locations. Plausible portfolios that don’t require too much transmission imagination might be N1 through N3 with say Q3- through Q7. Q8 and Q9 are too close to the northern NSW zones including Orana and don’t give the same portfolio benefit.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="media/media/image15.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="page10image1933724720"><img src="media/media/image15.png" style="width:6.26389in;height:8.77361in" alt="page10image1933724720" class="figure-img"></a></p>
<figcaption>page10image1933724720</figcaption>
</figure>
</div>
<p>Figure 15 Modelled NSW and QLD REZs. Source: AEMO</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="media/media/image16.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="page10image1933724928"><img src="media/media/image16.png" style="width:0.51111in;height:0.33333in" alt="page10image1933724928" class="figure-img"></a></p>
<figcaption>page10image1933724928</figcaption>
</figure>
</div>
<p>Equally large scale solar can be built faster and possibly has a lower cost of energy than wind. Notionally such a large project could also manage the risk with access the spot market given the predictable surplus of midday power coming from behind the meter. That is you might undersize your contracted portfolio. That too is ignored here.</p>
<p>For most renewable systems in Australia, the general finding is that the ideal mix is about 70% wind and 30% solar. Because of the large solar resource in QLD and because we are viewing the refinery(s) as a pseudo battery lets push up the solar ratio to 50% with say 35% of power coming from QLD wind and 15% from NSW wind. I don’t worry about the solar side of things except to note that spreading the solar out within QLD will likely improve results.</p>
<p>These numbers are just guesss.</p>
<p>All real world issues like transmission are completely ignored.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/itkservices3\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024 ITK admin@itkservices.com.au</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>