<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Leitch">
<meta name="dcterms.date" content="2025-08-03">

<title>Droughts – ITK Research</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../ITK_logo.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-485e50d28d76f17c9a54ab231639fb97.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-f9f99e9f92a7e94224d7c17645ae6320.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script defer="" data-domain="itkservices3.com" src="https://plausible.io/js/script.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Droughts – ITK Research">
<meta property="og:description" content="Electricity markets analysis">
<meta property="og:image" content="https://itkservices3.com/media/image-20250805180118537.png">
<meta property="og:site_name" content="ITK Research">
<meta property="og:image:height" content="1187">
<meta property="og:image:width" content="1785">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../ITK_logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ITK Research</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-dashboards-(load-slow" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Dashboards (load slow)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-dashboards-(load-slow">    
        <li>
    <a class="dropdown-item" href="../IEA.html">
 <span class="dropdown-text">IEA-electricity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../nemgen.html">
 <span class="dropdown-text">NEM-ITK</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../forecast.html">
 <span class="dropdown-text">AEMO demand fcst</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../posts.html"> 
<span class="menu-text">Articles</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-more" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">more</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-more">    
        <li>
    <a class="dropdown-item" href="../green_iron/index.html">
 <span class="dropdown-text">Green Iron</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../presentations.html">
 <span class="dropdown-text">Presentations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../background.html">
 <span class="dropdown-text">Background notes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../energyinsiders.html">
 <span class="dropdown-text">Energy Insiders</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="../posts.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../mailchimp.html"> 
<span class="menu-text">Signup</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Droughts</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">analysis</div>
                <div class="quarto-category">prices</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>David Leitch </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 3, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#vre-droughts-matter-more-for-prices-than-reliability" id="toc-vre-droughts-matter-more-for-prices-than-reliability" class="nav-link active" data-scroll-target="#vre-droughts-matter-more-for-prices-than-reliability">VRE droughts matter more for prices than reliability</a></li>
  <li><a href="#long-duration-storage-is-cheaper-because-it-sacrifices-power-for-lower-cost" id="toc-long-duration-storage-is-cheaper-because-it-sacrifices-power-for-lower-cost" class="nav-link" data-scroll-target="#long-duration-storage-is-cheaper-because-it-sacrifices-power-for-lower-cost">Long duration storage is cheaper because it sacrifices power for lower cost</a></li>
  <li><a href="#data-and-methods" id="toc-data-and-methods" class="nav-link" data-scroll-target="#data-and-methods">Data and methods</a></li>
  <li><a href="#general-results-and-profile" id="toc-general-results-and-profile" class="nav-link" data-scroll-target="#general-results-and-profile">General results and profile</a></li>
  <li><a href="#variability-and-droughts" id="toc-variability-and-droughts" class="nav-link" data-scroll-target="#variability-and-droughts">Variability and droughts</a></li>
  <li><a href="#trading-and-planning-thoughts" id="toc-trading-and-planning-thoughts" class="nav-link" data-scroll-target="#trading-and-planning-thoughts">Trading and planning thoughts</a></li>
  <li><a href="#supplement-how-meteorologists-define-droughts" id="toc-supplement-how-meteorologists-define-droughts" class="nav-link" data-scroll-target="#supplement-how-meteorologists-define-droughts">Supplement: How meteorologists define droughts</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="droughts.docx"><i class="bi bi-file-word"></i>MS Word</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="vre-droughts-matter-more-for-prices-than-reliability" class="level2">
<h2 class="anchored" data-anchor-id="vre-droughts-matter-more-for-prices-than-reliability">VRE droughts matter more for prices than reliability</h2>
<p>Long duration VRE droughts are not that long or that severe. Nevertheless electricity spot prices are very elastic so we need to distinguish between the implications of droughts for reliability and the implication for prices.</p>
<p>The analysis below leads me to think that 24 hour continuous periods where wind and solar output was less than 66% of average will happen only about 6% of the time. That’s not a drought by the standards of rainfall. Its hardly even a dry season. Rain droughts can go for years.</p>
<p>This article only focusses on utility wind and solar, uses the 2035 capacities by REZ assumed in the 2024 ISP for 2035 and then applies those capacities to the ISP weather traces. On that basis…</p>
<p><strong>There are fewer than 0.5% of days where wind and solar output will be below 66% of normal for four days or longer in a row.</strong></p>
<p>Even on those extreme days 8 GW of dispatchable power running continuously for a week would cover the short fall as can be seen from fig 10. That’s the sort of event that open cycle gas or diesel generation can indeed cover, although even the fuel for that would probably need storage.</p>
<p>By contrast we can look at the much higher frequency of low outputs over 4 and 8 hours.</p>
<p>It’s not the way I normally analyse things but the following plot is one way of thinking about the relative opportunity set for four and eight hour batteries. P5 is where hourly output is in the lowest 5% of hours for either four or eight continuous hours. P40 is where output is in the lowest 40% of hours for four or eight continuous hours. It’s likely that prices will be highest for the P5 and lowest in this plot for the P40 events. So the plot gives an idea of the likely high price events. For 8 hour batteries there are far fewer opportunities to use the full 8 hours. But then 8 hour batteries have much lower unit costs than 4 hour batteries</p>
<div id="fig-" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../media/image-20250805202740490.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Battery opportunity set"><img src="../media/image-20250805202740490.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Battery opportunity set
</figcaption>
</figure>
</div>
</section>
<section id="long-duration-storage-is-cheaper-because-it-sacrifices-power-for-lower-cost" class="level2">
<h2 class="anchored" data-anchor-id="long-duration-storage-is-cheaper-because-it-sacrifices-power-for-lower-cost">Long duration storage is cheaper because it sacrifices power for lower cost</h2>
<p>Storage is often divided into short, medium and long duration classes. Duration is defined as the quantity of storage/power (maximum rate) at which it can be delivered or charged.</p>
<p>Generally the longer the duration the storage the cheaper it is on an energy basis The cheapness comes because by definition long duration storage can only be delivered or recharged slowly. The cheapness comes because power is sacrificed for duration.</p>
<p>Measured on a power basis a long duration storage system is likely to be more expensive than a short duration system. At today’s price 2 GW of 4 hour batteries would cost no more than $3.2 bn compared to Snowy 2 cost of $12 bn. 2 GW of 4 hour batteries can be built and connected in 18 months. I suspect 2 GW of 8 hour batteries could be done for under $5 bn. So I’d need a lot of convincing about the value of that extra duration before I wanted to spend 4X the money and have a much lower round trip efficiency.</p>
<p>For pumped hydro the total cost of the storage divides between the pumping or generation power, the tunnel capacity, and the size of the dams. Dams have an economy in that volume grows at 2/3 the cube of the radius. So expanding the radius by say 2 metres adds close to 6 cubic metres of storage. In practice for pumped hydro though this advantage has to be offset against, the fact you need two dams, plus the race or tunnels needed to circulate the water up and down. There are in fact lots of other disadvantages.</p>
<p><span class="math inline">\(V = \frac{1}{2} \cdot \frac{4}{3} \pi r^3 = \frac{2}{3} \pi r^3\)</span></p>
<p>For lithium batteries the total cost divides between the cost of the inverters and the cost of the cells. Each cell of a given class has the same cost as every other cell. The economy comes because you use less inverters and put the cells in parallel instead of in series.</p>
<p>Again the point is that to get lower cost for a given quantity you have to sacrifice power.</p>
</section>
<section id="data-and-methods" class="level2">
<h2 class="anchored" data-anchor-id="data-and-methods">Data and methods</h2>
<p>AEMO provide 12 reference years of <a href="https://aemo.com.au/energy-systems/major-publications/integrated-system-plan-isp/2024-integrated-system-plan-isp">wind and solar traces</a> . That data set provide the output (capacity factor for each 30 minutes) for a 1 MW standardised wind turbine or solar farm for every REZ for every half hour for a 34 year forward period. That adds up to about 2.5 bn data points. Not something you want to open in Excel necessarily.</p>
<p>Although I could have worked with just the weather data I decided to use AEMO modelled capacities installed and so enabling the calculation of gross energy output for each of those half hours. To do that I used the wind and solar capacities that were installed as the beginning of 2035 in the 2024 ISP. AEMO provides that data. This has the advantage of being:</p>
<ul>
<li>practical, AEMO only installs wind or solar in some REZs ones where obviously they model to have transmission available; and</li>
<li>is the capacity required, with the other generation ie rooftop, hydro, batteries, gas to keep the lights on;</li>
<li>by 2035 in the central ISP scenario there is virtually no coal left.</li>
</ul>
<p>So for each of 12 reference years, for 34 calendar years (408 sample years) of forecast with each reference year running from 2021 to 2055. Each of the 34 years of each reference year has 17520 half hours in the year. And for each of those half hours we have 34 REZs. The code takes the wind and the solar capacity in each REZ and multiplies by the capacity factor for that half hour in that REZ. Of course this doesn’t allow for physical or economic curtailment or MLFs. Actual output if this capacity was installed would be less. On the other hand rooftop solar is excluded as are all other forms of generation. Its just about utility wind and solar.</p>
</section>
<section id="general-results-and-profile" class="level2">
<h2 class="anchored" data-anchor-id="general-results-and-profile">General results and profile</h2>
<p>There are lots of visualisations in this section. Let’s start with how the wind and solar capacity is installed by State in 2035 in the 2024 ISP Central Scenario. It’s this one set of capacities that are used in all other plots. Perhaps the most obvious point is how much is installed in QLD. That’s what Queenslanders are currently cutting off their noses to spite their faces for. A chance to be leader.</p>
<div id="fig-" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../media/image-20250805173652355.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: VRE capacity by fuel and Region in 2035 ISP"><img src="../media/image-20250805173652355.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: VRE capacity by fuel and Region in 2035 ISP
</figcaption>
</figure>
</div>
<p>So the 2024 ISP was dominated by wind but also included, because it’s Victorian Govt policy, some offshore wind. And because capacity factors of solar are less than wind, about 70% of the utility scale VRE is wind.</p>
<div id="fig-" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../media/image-20250805174341403.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Capacity v average energy."><img src="../media/image-20250805174341403.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Capacity v average energy.
</figcaption>
</figure>
</div>
<p>And then this is the output expressed as an index over the year also showing the P5 and the P95 lines. P5 means that 5% of observations are less than that line, P95 that 95% of observations are less than the line. The data was smoothed a bit to make the message such as it is more obvious.</p>
<div id="fig-" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../media/image-20250805174109840.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Weekly VRE index"><img src="../media/image-20250805174109840.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Weekly VRE index
</figcaption>
</figure>
</div>
<p>And we can look at the average day which will have a very familiar shape.</p>
<div id="fig-" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../media/image-20250805174420985.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Daily area shape"><img src="../media/image-20250805174420985.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Daily area shape
</figcaption>
</figure>
</div>
<p>The output is actually relatively steady month to month and that’s because QLD provides a very steady baseline. Wind is the middle plot of the three. Again note that all these plots exclude rooftop.</p>
<div id="fig-" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../media/image-20250805174536988.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: Seasonality by region"><img src="../media/image-20250805174536988.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Seasonality by region
</figcaption>
</figure>
</div>
<p>Finally in this general section we can look at the distribution of output and it is close enough for jazz as a normal distribution</p>
<div id="fig-" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../media/image-20250805174840991.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;7: Distribution of energy output"><img src="../media/image-20250805174840991.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Distribution of energy output
</figcaption>
</figure>
</div>
</section>
<section id="variability-and-droughts" class="level2">
<h2 class="anchored" data-anchor-id="variability-and-droughts">Variability and droughts</h2>
<p>Compared to rainfall there are no droughts. Rain droughts can go on for years. The sun shines every day. We can rearrange the output to show percentiles of daily, weekly and monthly averages. Just like P5 and P95 these plots show the percentage of days or weeks where the output is less than the xth percentile.</p>
<p>I’ve shown this chart as an index, P50 for each series is the median, not the mean.</p>
<div id="fig-" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../media/image-20250805175601617.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;8: daily, weekly and monthly percentiles of output as an index"><img src="../media/image-20250805175601617.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: daily, weekly and monthly percentiles of output as an index
</figcaption>
</figure>
</div>
<p>On a monthly basis there is no month where output is less than 80% of the median.</p>
<p>What about these famous cold Winter months we hear so much about. Well this plot captures all the sequences of a day or longer where output was in the lowest 10% of days. Note that the 10% cutoff point still has output at roughly 2/3 of average output, that is the P10 threshold output for a day is 443 GWh which about 68% of average day output. Down but far from zero. Using that threshold a drought of 4 days or longer happens about 0.5% of the time.</p>
<div id="fig-" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../media/image-20250805180118537.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;9: drought duration"><img src="../media/image-20250805180118537.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: drought duration
</figcaption>
</figure>
</div>
<p>If we add up the output of the 4 days and longer droughts we can compare the average day of an extreme drought with the average day over the entire set.</p>
<div id="fig-" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../media/image-20250805180326200.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;10: drought output daily shape"><img src="../media/image-20250805180326200.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: drought output daily shape
</figcaption>
</figure>
</div>
<p>My takeaway from this last plot is that around 8 GW of reserve capacity capable of operating for a week is required. Of course its not that simple but it does provide a visible sizing dimension.</p>
</section>
<section id="trading-and-planning-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="trading-and-planning-thoughts">Trading and planning thoughts</h2>
<p>June, July and August are less predictable than other months. So if you are a trader you would want to consider your downside as well as the upside.</p>
<div id="fig-" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../media/image-20250805182027989.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;11: Relative seasonal volatility and distribution"><img src="../media/image-20250805182027989.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Relative seasonal volatility and distribution
</figcaption>
</figure>
</div>
<p>It also looks to me, and I am not a trader, that between say March and September there are more times when the number comes in below the average than there are times when it comes in above. This may mean that being short in those months will mostly prove to be a profitable strategy but stands the risk of being completely wrong.</p>
</section>
<section id="supplement-how-meteorologists-define-droughts" class="level2">
<h2 class="anchored" data-anchor-id="supplement-how-meteorologists-define-droughts">Supplement: How meteorologists define droughts</h2>
<section id="threshold-based-percent-of-normal" class="level5">
<h5 class="anchored" data-anchor-id="threshold-based-percent-of-normal">Threshold-Based (Percent-of-Normal)</h5>
<p>A simple and commonly used definition involves comparing observed precipitation to a long-term average. A drought occurs when <strong>precipitation falls below a defined percentage</strong> of that average over a specific period.</p>
<ul>
<li><strong>Example</strong>: Precipitation is less than <strong>75%</strong> of the 30-year mean over a 3-month period.</li>
<li>The percentage threshold and timescale may vary by region or application.</li>
</ul>
</section>
<section id="duration-based" class="level5">
<h5 class="anchored" data-anchor-id="duration-based">Duration-Based</h5>
<p>A drought is often defined as lasting a <strong>minimum time period</strong>, such as several weeks or months.</p>
<ul>
<li><strong>Example</strong>: No significant rainfall for <strong>at least 14 consecutive days</strong>.</li>
</ul>
</section>
<section id="spi-standardized-precipitation-index" class="level5">
<h5 class="anchored" data-anchor-id="spi-standardized-precipitation-index">SPI (Standardized Precipitation Index)</h5>
<ul>
<li>Based purely on precipitation data.</li>
<li>Converts rainfall into a standardized normal distribution.</li>
<li>Can be calculated over 1-, 3-, 6-, 12-month periods to capture short- and long-term droughts.</li>
</ul>
<p><strong>Classification</strong>:</p>
<ul>
<li>SPI &lt; -1.0 → Moderate drought<br>
</li>
<li>SPI &lt; -1.5 → Severe drought<br>
</li>
<li>SPI &lt; -2.0 → Extreme drought</li>
</ul>
</section>
<section id="rainfall-deficit-anomaly" class="level5">
<h5 class="anchored" data-anchor-id="rainfall-deficit-anomaly">Rainfall Deficit (Anomaly)</h5>
<p>A simple but effective method is to look at the <strong>rainfall deficit</strong>:</p>
<pre class="math"><code>Deficit = Mean rainfall - Actual rainfall</code></pre>
<p>This method helps estimate <strong>cumulative shortfall</strong> over a defined time period.</p>
<p>Whether for rainfall, wind, or solar, you can define a drought using several key attributes:</p>
<table class="table">
<thead>
<tr class="header">
<th>Attribute</th>
<th>Example Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Threshold</strong></td>
<td>Rainfall &lt; 75% of long-term average</td>
</tr>
<tr class="even">
<td><strong>Duration</strong></td>
<td>At least 2 continuous weeks</td>
</tr>
<tr class="odd">
<td><strong>Severity</strong></td>
<td>SPI &lt; -1.5 or large cumulative deficit</td>
</tr>
<tr class="even">
<td><strong>Frequency</strong></td>
<td>Number of droughts per season or year</td>
</tr>
<tr class="odd">
<td><strong>Recovery</strong></td>
<td>Time taken to return to average or normal levels</td>
</tr>
</tbody>
</table>
<hr>


</section>
</section>

</main> <!-- /main -->
<script data-isso="//comentario3.itkservices2.com/" data-isso-css="true" data-isso-css-url="null" data-isso-lang="en" data-isso-max-comments-top="10" data-isso-max-comments-nested="5" data-isso-reveal-on-click="5" data-isso-avatar="false" data-isso-avatar-bg="#f0f0f0" data-isso-avatar-fg="#9abf88 #5698c4 #e279a3 #9163b6 ..." data-isso-vote="true" data-isso-vote-levels="" data-isso-page-author-hashes="f124cf6b2f01,7831fe17a8cd" data-isso-reply-notifications-default-enabled="false" src="https://comentario3.itkservices2.com/js/embed.min.js"></script>
        <section id="isso-thread" data-title="Test tag"></section>
   
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/itkservices3\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024 ITK admin@itkservices.com.au</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>